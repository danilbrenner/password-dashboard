// filepath: /Users/danil/repos/password-dashboard/passwords_etl/models/staging/stg_in_master_passwords.yml
unit_tests:
  - name: test_stg_in_master_passwords_export_ts_parsing
    model: stg_in_master_passwords

    given:
      - input: ref('raw_master_passwords')
        rows:
          - {
            hash: "abc123",
            filename: "azure://password-dashboard/20251012154536/mp.csv"
          }
          - {
            hash: "def456",
            filename: "azure://password-dashboard/20251101120000/mp.csv"
          }

    expect:
      rows:
        - {
          hash: "abc123",
          export_ts: "2025-10-12 15:45:36"
        }
        - {
          hash: "def456",
          export_ts: "2025-11-01 12:00:00"
        }

    overrides:
      macros:
        is_incremental: false

